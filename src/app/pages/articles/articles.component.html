<h3>Recherche</h3>
 <div nz-row nzGutter="16" class="mb-3">
    <div nz-col nzSpan="8">
      <label for="libArt" class="form-label">Libellé</label>
      <input nz-input id="libArt" placeholder="Rechercher par libellé"
             [(ngModel)]="filters.libArt" (input)="applyFilters()"/>
    </div>

    <div nz-col nzSpan="8">
      <label for="type" class="form-label">Type</label>
      <input nz-input id="type" placeholder="Rechercher par type"
             [(ngModel)]="filters.type" (input)="applyFilters()"/>
    </div>

    <div nz-col nzSpan="8">
      <label for="etat" class="form-label">État</label>
      <input nz-input id="etat" placeholder="Rechercher par état"
             [(ngModel)]="filters.etat" (input)="applyFilters()"/>
    </div>
  </div>

  <div nz-row nzGutter="16" class="align-items-end">
    <div nz-col nzSpan="8">
      <label for="marque" class="form-label">Marque</label>
      <select nz-select id="marque" class="form-select"
              [(ngModel)]="filters.marqueId" (change)="applyFilters()">
        <option value="">Toutes</option>
        <option *ngFor="let marque of marques" [value]="marque.id">{{ marque.nom }}</option>
      </select>
    </div>

    <div nz-col nzSpan="8">
      <label for="categorie" class="form-label">Catégorie</label>
      <select nz-select id="categorie" class="form-select"
              [(ngModel)]="filters.categorieId" (change)="applyFilters()">
        <option value="">Toutes</option>
        <option *ngFor="let categorie of categories" [value]="categorie.id">{{ categorie.nom }}</option>
      </select>
    </div>

    <div nz-col nzSpan="8" class="text-end">
      <button nz-button nzType="primary" (click)="applyFilters()" class="mt-3">
        Rechercher
      </button>
    </div>
  </div>


<div class="header-bar">
  <h1>Ajouter un article</h1>
  <button class="btn btn-primary" (click)="onCreateArticle()" *hasPermission="'CREATE_ARTICLES'">
    <span nz-icon nzType="plus"></span> Créer un article
  </button>
</div>


<table class="table table-bordered table-hover table-sm text-center mt-3" aria-describedby="page-heading">
  <thead class="table-primary">
    <tr>
      <th class="text-center">Libellé</th>
      <th class="text-center">Stock</th>
      <th class="text-center">Niveau Alerte</th>
      <th class="text-center">Type</th>
      <th class="text-center">État</th>
      <th class="text-center">Marque</th>
      <th class="text-center">Catégorie</th>
      <th class="text-center">Actions</th>
    </tr>
  </thead>
  <tbody>
    @for (article of filteredArticles; track article.id) {
      <tr>
        <td class="text-center">
          <div class="d-flex justify-content-center align-items-center">
            <img *ngIf="article.imageFileType"
            [src]="'data:'+article.imageFileType + ';base64,' + article.imageData"
            alt="Image de l'article"
            width="40" height="40"
            style="object-fit: cover; border-radius: 50px; border: 1px solid #ccc;" />
          <span class="ms-2">{{ article.libArt }}</span>
          </div>
        </td>
        <td class="text-center">{{ article.stock }}</td>
        <td class="text-center">{{ article.niveauAlert }}</td>
        <td class="text-center">{{ article.type }}</td>
        <td class="text-center">{{ article.etat }}</td>
        <td class="text-center">{{ article.marqueNom }}</td>
        <td class="text-center">{{ article.categorieNom }}</td>
        <td class="text-center">
          <div class="btn-group">
            <a class="btn btn-info btn-sm me-2" data-bs-toggle="tooltip" title="Detail" (click)="onDetail(article)" *hasPermission="'DETAIL_ARTICLES'">
            <i class="bi bi-eye"></i> 
          </a>
          <a class="btn btn-warning btn-sm me-2" data-bs-toggle="tooltip" title="Modifier" (click)="onEdit(article)" *hasPermission="'EDIT_ARTICLES'">
            <i class="bi bi-pencil"></i>
          </a>
          <a class="btn btn-danger btn-sm" data-bs-toggle="tooltip" title="Supprimer" (click)="onDelete(article)" *hasPermission="'DELETE_ARTICLES'">
            <i class="bi bi-trash"></i>
          </a>
          </div>
        </td>
      </tr>
    }
  </tbody>
</table>


<nz-pagination
  [nzSimple]="false"
  [nzHideOnSinglePage]="true"
  [nzPageIndex]="pageNumber"
  [nzTotal]="totalElements"
  [nzPageSize]="sizeNumber"
  (nzPageIndexChange)="navigateToPage($event)">
</nz-pagination>

